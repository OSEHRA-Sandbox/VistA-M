PSN565PO ;BIR/SJA-Post install routine for patch PSN*4*565 ; 02 Aug 2018  2:00 PM
 ;;4.0;NATIONAL DRUG FILE;**565**; 30 Oct 98;Build 16
 ;
 Q
POST ; entry point
 N CNT,DATA,II,NAME,NODE1,PSNDA
 S CNT=4 K ^TMP("PSN",$J)
 D BMES^XPDUTL("  Starting post-install for PSN*4*565")
 D BMES^XPDUTL("  Restore GCNSEQNO field for specific VA Products....")
 F II=1:1 S DATA=$P($T(@("LIST+"_II_"^PSN565PO")),";;",2) Q:DATA=""  D
 . S PSNDA=+DATA,NAME=$E($P($G(^PSNDF(50.68,PSNDA,0)),"^"),1,40),NODE1=$G(^PSNDF(50.68,PSNDA,1))
 . I $D(^PSNDF(50.68,PSNDA,0)),'$P(NODE1,"^",5) S $P(^PSNDF(50.68,PSNDA,1),"^",5)=$E(1000000+$P(DATA,",",2),2,7) D
 . . S CNT=CNT+1,^TMP("PSN",$J,CNT)=PSNDA_$J("",15-$L(PSNDA))_NAME_$J("",50-$L(NAME))_$E(1000000+$P(DATA,",",2),2,7)
 D EN^PSN565P1
 D MSG K ^TMP("PSN",$J)
 ; delete routine PSN565P1
 S X="PSN565P1" X ^%ZOSF("TEST") I $T D MES^XPDUTL("  Deleting routine "_X_"...") X ^%ZOSF("DEL")
 D BMES^XPDUTL("  Finished post-install for PSN*4*565")
 Q
 ;
MSG ; Sends Mailman message about updates
 N XMX,XMSUB,XMDUZ,XMTEXT
 S II=0 F  S II=$O(^XUSEC("PSNMGR",II)) Q:'II  S XMY(II)=""
 S XMY(DUZ)="",XMSUB="PSN*4*565 - GCNSEQNO field Update"
 S ^TMP("PSN",$J,1)="The post-install routine restored the GCNSEQNO field value for the following VA PRODUCT entries:"
 S ^TMP("PSN",$J,2)=""
 S ^TMP("PSN",$J,3)="VA Product #   Product Name                                      GCNSEQNO   "
 S ^TMP("PSN",$J,4)="------------   ----------------------------------------          --------"
 S:'$D(^TMP("PSN",$J,5)) ^TMP("PSN",$J,5)="No updates performed."
 S XMDUZ=.5,XMTEXT="^TMP(""PSN"",$J," N DIFROM D ^XMD
 Q
LIST ; VA PRODUCT entries missing GCNSEQNO field
 ;;1,4826
 ;;30,4175
 ;;38,4174
 ;;61,224
 ;;108,3577
 ;;111,3586
 ;;196,8873
 ;;211,43349
 ;;230,16065
 ;;252,22345
 ;;256,22345
 ;;288,3262
 ;;311,8809
 ;;329,5053
 ;;426,2142
 ;;429,2118
 ;;459,1220
 ;;498,8084
 ;;521,3147
 ;;532,24137
 ;;560,3603
 ;;569,9283
 ;;585,327
 ;;586,326
 ;;597,4278
 ;;598,2549
 ;;610,7480
 ;;611,4647
 ;;648,64586
 ;;662,4261
 ;;706,64537
 ;;707,64539
 ;;815,15536
 ;;816,15537
 ;;894,6997
 ;;943,8295
 ;;970,21205
 ;;985,7682
 ;;991,7679
 ;;1027,26869
 ;;1029,26869
 ;;1073,3202
 ;;1075,3203
 ;;1079,3117
 ;;1144,2492
 ;;1145,48094
 ;;1158,2251
 ;;1164,63385
 ;;1170,1386
 ;;1177,39753
 ;;1178,2511
 ;;1196,39742
 ;;1209,67478
 ;;1210,2477
 ;;1231,15466
 ;;1260,2510
 ;;1272,2477
 ;;1283,42926
 ;;1303,3167
 ;;1327,3648
 ;;1328,3656
 ;;1341,4675
 ;;1357,9218
 ;;1358,9223
 ;;1359,9219
 ;;1365,15943
 ;;1366,16815
 ;;1404,63829
 ;;1457,62033
 ;;1461,2523
 ;;1472,59703
 ;;1475,2532
 ;;1478,2470
 ;;1480,2470
 ;;1484,2475
 ;;1488,2532
 ;;1500,2522
 ;;1501,2470
 ;;1502,2523
 ;;1514,2530
 ;;1520,2532
 ;;1522,2482
 ;;1530,6440
 ;;1534,6435
 ;;1535,2470
 ;;1541,2524
 ;;1579,4755
 ;;1631,59782
 ;;1639,36045
 ;;1640,36047
 ;;1641,36046
 ;;1651,66719
 ;;1688,4767
 ;;1715,48548
 ;;1725,516
 ;;1727,517
 ;;1842,4167
 ;;1855,4734
 ;;1914,4521
 ;;1921,4521
 ;;1978,43762
 ;;2168,45266
 ;;2169,45266
 ;;2173,5230
 ;;2184,6503
 ;;2317,66111
 ;;2394,8366
 ;;2409,8259
 ;;2439,62665
 ;;2486,4220
 ;;2487,4222
 ;;2488,4221
 ;;2490,4223
 ;;2590,3310
 ;;2618,3314
 ;;2621,3314
 ;;2625,3314
 ;;2770,6551
 ;;2802,4515
 ;;2803,4513
 ;;2821,4217
 ;;2833,17240
 ;;2835,62407
 ;;2884,65025
 ;;2885,65028
 ;;2963,23796
 ;;2966,31755
 ;;2971,48544
 ;;2981,8818
 ;;2984,8817
 ;;2992,61483
 ;;3004,4746
 ;;3005,1272
 ;;3070,25697
 ;;3071,25698
 ;;3094,93
 ;;3200,8821
 ;;3207,4024
 ;;3225,64635
 ;;3251,9278
 ;;3286,8910
 ;;3415,64266
 ;;3465,65849
 ;;3472,7650
 ;;3484,7414
 ;;3485,7415
 ;;3506,4029
 ;;3521,41745
 ;;3551,7818
 ;;3568,62018
 ;;3569,62014
 ;;3599,6209
 ;;3603,75213
 ;;3659,70911
 ;;3725,4760
 ;;3791,4291
 ;;3825,60678
 ;;3849,7409
 ;;3857,38861
 ;;3858,38861
 ;;3859,38861
 ;;4045,17179
 ;;4069,63153
 ;;4092,3237
 ;;4147,15353
 ;;4168,45669
 ;;4173,59297
 ;;4189,59216
 ;;4216,7522
 ;;4219,47096
 ;;4236,3613
 ;;4239,3617
 ;;4256,130
 ;;4257,132
 ;;4259,133
 ;;4265,170
 ;;4266,48478
 ;;4305,64271
 ;;4357,59738
 ;;4372,16025
 ;;4376,2623
 ;;4392,66497
 ;;4410,4204
 ;;4411,4199
 ;;4412,4206
 ;;4417,4207
 ;;4418,4202
 ;;4419,4205
 ;;4420,16899
 ;;4423,26439
 ;;4529,3998
 ;;4546,4503
 ;;4560,6599
 ;;4565,1707
 ;;4638,3990
 ;;4639,3987
 ;;4640,3989
 ;;4641,3991
 ;;4644,4518
 ;;4658,23446
 ;;4687,3290
 ;;4692,3294
 ;;4693,3295
 ;;4724,3295
 ;;4733,7006
 ;;4753,5810
 ;;4754,5813
 ;;4780,2348
 ;;4848,910
 ;;4867,749
 ;;4928,652
 ;;4933,66240
 ;;4953,7806
 ;;4982,7869
 ;;4986,4836
 ;;5067,4777
 ;;5091,4901
 ;;5093,45003
 ;;5103,30255
 ;;5112,29054
 ;;5190,4385
 ;;5266,6762
 ;;5313,5763
 ;;5317,5792
 ;;5335,63556
 ;;5338,63564
 ;;5374,1242
 ;;5388,62013
 ;;5393,62014
 ;;5394,62015
 ;;5404,2018
 ;;5405,48631
 ;;5452,1965
 ;;5518,1189
 ;;5547,6364
 ;;5599,48620
 ;;5646,63537
 ;;5647,1814
 ;;5659,3376
 ;;5662,1285
 ;;5671,4535
 ;;5672,4535
 ;;5687,2013
 ;;5699,2015
 ;;5705,2012
 ;;5767,1233
 ;;5768,1233
 ;;5776,20614
 ;;5792,11990
 ;;5817,996
 ;;5819,16967
 ;;5848,2380
 ;;5897,53015
 ;;5911,27826
 ;;5913,13047
 ;;6034,11644
 ;;6039,8078
 ;;6095,4458
 ;;6114,62885
 ;;6119,13675
 ;;6130,1240
 ;;6148,570
 ;;6151,16849
 ;;6152,16850
 ;;6153,16572
 ;;6155,16570
 ;;6156,16571
 ;;6157,17205
 ;;6158,21282
 ;;6159,24536
 ;;6160,24537
 ;;6161,24538
 ;;6162,24539
 ;;6163,24478
 ;;6164,571
 ;;6165,572
 ;;6166,21282
 ;;6180,4311
 ;;6181,4312
 ;;6225,2400
 ;;6232,5000
 ;;6234,47133
 ;;6236,5001
 ;;6273,1154
 ;;6300,11663
 ;;6402,1711
 ;;6464,61353
 ;;6484,6315
 ;;6486,33862
 ;;6489,6303
 ;;6490,47875
 ;;6543,8250
 ;;6545,17000
 ;;6562,25061
 ;;6606,8893
 ;;6607,8887
 ;;6608,8889
 ;;6609,8888
 ;;6637,1515
 ;;6640,4491
 ;;6858,1688
 ;;6871,45242
 ;;6908,53698
 ;;6980,48556
 ;;7017,644
 ;;7031,45243
 ;;7032,45244
 ;;7033,45243
 ;;7046,1718
 ;;7054,7601
 ;;7077,2082
 ;;7080,9582
 ;;7081,9583
 ;;7091,5737
 ;;7094,5738
 ;;7140,4114
 ;;7175,16653
 ;;7291,9676
 ;;7309,3542
 ;;7354,13021
 ;;7380,48555
 ;;7448,12076
 ;;7474,48395
 ;;7588,1340
 ;;7644,19923
 ;;7648,4747
 ;;7673,7209
 ;;7674,7216
 ;;7685,13673
 ;;7700,15762
 ;;7761,61935
 ;;7782,31427
 ;;7819,9813
 ;;7842,16879
 ;;7878,8322
 ;;7880,8321
 ;;7882,5637
 ;;7884,14291
 ;;7894,15953
 ;;7898,2701
 ;;7916,5352
 ;;7917,5350
 ;;7918,64363
 ;;7920,8515
 ;;7921,5349
 ;;7931,60636
 ;;7946,65585
 ;;7967,2948
 ;;7980,16811
 ;;7981,16812
 ;;7982,16813
 ;;7991,2984
 ;;7992,2983
 ;;8002,61709
 ;;8051,64530
 ;;8054,3046
 ;;8061,35527
 ;;8077,14134
 ;;8078,63178
 ;;8079,7993
 ;;8080,14134
 ;;8094,1602
 ;;8096,63050
 ;;8129,65583
 ;;8156,9183
 ;;8170,61254
 ;;8225,7513
 ;;8226,7546
 ;;8241,48754
 ;;8242,48754
 ;;8281,1628
 ;;8304,71662
 ;;8319,33530
 ;;8320,43136
 ;;8434,25696
 ;;8459,2681
 ;;8469,7772
 ;;8473,7785
 ;;8490,2819
 ;;8508,23759
 ;;8527,46237
 ;;8528,31439
 ;;8577,2860
 ;;8686,52108
 ;;8694,2551
 ;;8703,8640
 ;;8738,8323
 ;;8750,23473
 ;;8754,3027
 ;;8755,3027
 ;;8767,3030
 ;;8813,29260
 ;;8826,15872
 ;;8834,23187
 ;;8870,14972
 ;;8882,63623
 ;;8890,22061
 ;;8911,63178
 ;;8912,63178
 ;;8913,7993
 ;;8939,5338
 ;;8961,46293
 ;;9049,5610
 ;;9067,24168
 ;;9089,16014
 ;;9091,38335
 ;;9134,70603
 ;;9135,58644
 ;;9269,5291
 ;;9295,15906
 ;;9375,7166
 ;;9379,60663
 ;;9406,8480
 ;;9412,5352
 ;;9461,1933
 ;;9462,1933
 ;;9464,1933
 ;;9465,1913
 ;;9466,1913
 ;;9478,65369
 ;;9492,13755
 ;;9564,7233
 ;;9616,8522
 ;;9632,6042
 ;;9639,23952
 ;;9641,21704
 ;;9726,47040
 ;;9731,18368
 ;;9745,16280
 ;;9771,60113
 ;;9847,74302
 ;;9848,2849
 ;;9879,14282
 ;;9908,17206
 ;;9962,7188
 ;;9966,6939
 ;;10017,5579
 ;;10064,8522
 ;;10132,48223
 ;;10147,7284
 ;;10183,11514
 ;;11299,10468
 ;;11574,61638
 ;;11723,63927
 ;;11750,8318
 ;;11815,46403
 ;;11930,66298
 ;;11935,66299
 ;;12147,21905
 ;;12235,11483
 ;;12253,22503
 ;;12359,24055
 ;;12404,5579
 ;;12504,5527
 ;;12505,5527
 ;;12520,17608
 ;;12521,24472
 ;;12611,27905
 ;;12613,26488
 ;;12615,26489
 ;;12625,30367
 ;;12639,28218
 ;;12654,63690
 ;;12674,29123
 ;;12675,1913
 ;;12730,27547
 ;;12758,64645
 ;;12759,64644
 ;;12771,41445
 ;;12772,41650
 ;;12787,45742
 ;;12789,45740
 ;;12812,37038
 ;;12813,37039
 ;;12829,39548
 ;;12843,39138
 ;;12877,30931
 ;;12880,46239
 ;;12881,46238
 ;;12902,37919
 ;;12903,37919
 ;;12952,4999
 ;;12964,19398
 ;;12973,3971
 ;;12975,44968
 ;;12977,40901
 ;;12997,58487
 ;;12998,58488
 ;;13002,40966
 ;;13058,24537
 ;;13059,24538
 ;;13060,24539
 ;;13061,24478
 ;;13069,11186
 ;;13070,16242
 ;;13078,23472
 ;;13079,40366
 ;;13080,23471
 ;;13081,3202
 ;;13082,3203
 ;;13144,65779
 ;;13150,23127
 ;;13241,71695
 ;;13257,23023
 ;;13287,16242
 ;;13288,16242
 ;;13307,41644
 ;;13310,24168
 ;;13314,22914
 ;;13353,34731
 ;;13455,27548
 ;;13456,27550
 ;;13465,22914
 ;;13472,63533
 ;;13509,42663
 ;;13563,21282
 ;;13564,16570
 ;;13565,16571
 ;;13568,41700
 ;;13613,2482
 ;;13688,266
 ;;13692,7225
 ;;13721,23129
 ;;13729,41698
 ;;13751,11186
 ;;13782,4439
 ;;13790,10458
 ;;13795,5633
 ;;13813,68636
 ;;13822,9846
 ;;13858,26490
 ;;13870,63717
 ;;13876,42800
 ;;13879,43879
 ;;13961,38264
 ;;13977,5125
 ;;14038,32174
 ;;14039,32600
 ;;14067,59459
 ;;14200,1933
 ;;14201,63940
 ;;14214,73689
 ;;14282,37029
 ;;14293,43761
 ;;14294,43760
 ;;14331,49375
 ;;14389,47608
 ;;14477,50836
 ;;14483,42966
 ;;14484,34359
 ;;14544,23882
 ;;14545,23881
 ;;14579,30007
 ;;14580,1913
 ;;14581,44337
 ;;14590,7663
 ;;14600,46484
 ;;14603,46698
 ;;14619,46942
 ;;14620,46754
 ;;14625,63189
 ;;14626,47021
 ;;14708,46295
 ;;14722,8111
 ;;14769,3590
 ;;14896,23881
 ;;14899,3656
 ;;14900,47429
 ;;14916,3295
 ;;14919,24441
 ;;14963,42081
 ;;14964,42082
 ;;14965,44853
 ;;15022,47323
 ;;15055,3313
 ;;15071,47318
 ;;15072,45981
 ;;15073,45982
 ;;15075,47525
 ;;15077,47526
 ;;15099,37754
 ;;15102,53036
 ;;15132,25621
 ;;15162,40224
 ;;15163,40223
 ;;15165,48077
 ;;15181,62817
 ;;15183,43899
 ;;15198,2582
 ;;15199,3290
 ;;15254,572
 ;;15333,47452
 ;;15363,571
 ;;15370,13648
 ;;15371,13649
 ;;15425,1913
 ;;15426,1913
 ;;15427,1913
 ;;15453,48456
 ;;15454,48456
 ;;15456,48978
 ;;15476,47763
 ;;15479,49828
 ;;15508,31376
 ;;15519,51202
 ;;15561,44226
 ;;15575,19
 ;;15595,26491
 ;;15613,2797
 ;;15657,65981
 ;;15695,1913
 ;;15696,1913
 ;;15697,1913
 ;;15731,16242
 ;;15772,64875
 ;;15897,50172
 ;;15923,47132
 ;;15924,50327
 ;;15931,22925
 ;;15933,47965
 ;;15957,43763
 ;;16090,53057
 ;;16091,53059
 ;;16092,53060
 ;;16093,53061
 ;;16198,50805
 ;;16237,30763
 ;;16252,51916
 ;;16260,50496
 ;;16266,16242
 ;;16267,16242
 ;;16268,50102
 ;;16327,52746
 ;;16349,1933
 ;;16353,5577
 ;;16358,49718
 ;;16359,52890
 ;;16360,52892
 ;;16361,52891
 ;;16377,65513
 ;;16384,51883
 ;;16416,10959
 ;;16445,52050
 ;;16455,64331
 ;;16458,53006
 ;;16459,53007
 ;;16468,24555
 ;;16469,3202
 ;;16470,23270
 ;;16471,3203
 ;;16472,16767
 ;;16476,24536
 ;;16477,24537
 ;;16478,24538
 ;;16479,24539
 ;;16480,24478
 ;;16484,13657
 ;;16509,21742
 ;;16556,50220
 ;;16557,50219
 ;;16569,45877
 ;;16570,58878
 ;;16571,58877
 ;;16572,58880
 ;;16627,48738
 ;;16686,16399
 ;;16704,2940
 ;;16721,45878
 ;;16722,58877
 ;;16723,48815
 ;;16747,49607
 ;;16774,51990
 ;;16781,52831
 ;;16823,60306
 ;;16839,27549
 ;;16853,57893
 ;;16878,57859
 ;;16882,57865
 ;;16884,57864
 ;;16885,57863
 ;;16892,38375
 ;;16909,58345
 ;;16914,49261
 ;;16961,49742
 ;;16963,27592
 ;;16968,39790
 ;;16971,40224
 ;;16972,40223
 ;;16979,23471
 ;;16980,23472
 ;;16986,60005
 ;
